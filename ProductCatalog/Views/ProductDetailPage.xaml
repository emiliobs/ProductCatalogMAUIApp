<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:ProductCatalog.ViewModels"
             xmlns:helpers="clr-namespace:ProductCatalog.Helpers"
             x:Class="ProductCatalog.Views.ProductDetailPage"
             x:DataType="vm:ProductDetailViewModel"
             Title="Product"
             BackgroundColor="#f5f7fa">
    <ScrollView>
        <StackLayout Padding="20" Spacing="20">

            <!-- TÃ­tulo -->
            <Label FontSize="28"
                   FontAttributes="Bold"
                   TextColor="#2D3436"
                   Margin="0,10,0,20">
                <Label.Text>
                    <Binding Path="IsEditMode">
                        <Binding.Converter>
                            <helpers:BoolToTextConverter TrueText="Edit Product" FalseText="New Product" />
                        </Binding.Converter>
                    </Binding>
                </Label.Text>
            </Label>

            <!--Imagen Section-->
            <Border BackgroundColor="White"
                    Padding="20"
                    StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="16"></RoundRectangle>
                </Border.StrokeShape>
                <Border.Shadow>
                    <Shadow Brush="Black" Opacity="0.05" Radius="10" Offset="0,2"></Shadow>
                </Border.Shadow>

                <StackLayout Spacing="15">
                    <Label Text="ðŸ“· Product Image"
                           FontSize="16"
                           FontAttributes="Bold"
                           TextColor="Black">
                    </Label>

                    <!--Imagen Preview-->
                    <Border WidthRequest="200"
                            HeightRequest="200"
                            BackgroundColor="#f0f0f0"
                            HorizontalOptions="Center"
                            StrokeThickness="2"
                            Stroke="#dfe6e9">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="12"></RoundRectangle>
                        </Border.StrokeShape>

                        <Image Aspect="AspectFill"
                             IsVisible="{Binding ImagePath}">
                            <Image.Source>
                                <FileImageSource File="{Binding ImagePath}" />
                            </Image.Source>
                        </Image>
                    </Border>

                    <!--Image Buttons-->
                    <Grid ColumnDefinitions="*,*,*" ColumnSpacing="10">
                        <Button Grid.Column="0" Text="ðŸ“·"
                                FontSize="24"
                                BackgroundColor="#3498db"
                                TextColor="White"
                                CornerRadius="10"
                                Command="{Binding TakePhotoCommand}"
                                ToolTipProperties.Text="Take Photo">
                        </Button>
                        <Button Grid.Column="1" Text="ðŸ–¼ï¸"
                                FontFamily="24"
                                BackgroundColor="#9b59b6"
                                TextColor="White"
                                CornerRadius="10"
                                Command="{Binding SelectPhotoCommand}"
                                ToolTipProperties.Text="Select from Gallery">
                        </Button>
                        <Button Grid.Column="2" Text="ðŸ—‘ï¸"
                                FontSize="24"
                                BackgroundColor="#e74c3c"
                                TextColor="White"
                                CornerRadius="10"
                                Command="{Binding DeletePhotoCommand}"
                                ToolTipProperties.Text="Delete Photo">
                        </Button>
                    </Grid>
                </StackLayout>
            </Border>

            <!-- Nombre -->
            <Border BackgroundColor="White"
                    Padding="16"
                    StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="12" />
                </Border.StrokeShape>
                <Border.Shadow>
                    <Shadow Brush="Black" Opacity="0.05" Radius="10" Offset="0,2" />
                </Border.Shadow>

                <StackLayout Spacing="8">
                    <Label Text="Name *"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="#2D3436" />
                    <Entry Text="{Binding Name}"
                           Placeholder="Ej: iPhone 15 Pro"
                           FontSize="16"
                           TextColor="#2D3436"
                           FontAttributes="Bold" />
                </StackLayout>
            </Border>

            <!-- DescripciÃ³n -->
            <Border BackgroundColor="White"
                    Padding="16"
                    StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="12" />
                </Border.StrokeShape>
                <Border.Shadow>
                    <Shadow Brush="Black" Opacity="0.05" Radius="10" Offset="0,2" />
                </Border.Shadow>

                <StackLayout Spacing="8">
                    <Label Text="Description"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="#2D3436" />
                    <Editor Text="{Binding Description}"
                            Placeholder="Describe the product..."
                            FontSize="16"
                            AutoSize="TextChanges"
                            MinimumHeightRequest="100"
                            TextColor="#2D3436"
                            FontAttributes="Bold" />
                </StackLayout>
            </Border>

            <!-- Precio y Cantidad -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="15">
                <!-- Precio -->
                <Border Grid.Column="0"
                        BackgroundColor="White"
                        Padding="16"
                        StrokeThickness="0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12" />
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="Black" Opacity="0.05" Radius="10" Offset="0,2" />
                    </Border.Shadow>

                    <StackLayout Spacing="8">
                        <Label Text="Price Â£ *"
                               FontSize="14"
                               FontAttributes="Bold"
                               TextColor="#2D3436" />
                        <Entry Text="{Binding PriceText}"
                               Keyboard="Numeric"
                               Placeholder="0.00"
                               FontSize="16"
                               TextColor="#2D3436"
                               FontAttributes="Bold" />
                    </StackLayout>
                </Border>

                <!-- Cantidad -->
                <Border Grid.Column="1"
                        BackgroundColor="White"
                        Padding="16"
                        StrokeThickness="0">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="12" />
                    </Border.StrokeShape>
                    <Border.Shadow>
                        <Shadow Brush="Black" Opacity="0.05" Radius="10" Offset="0,2" />
                    </Border.Shadow>

                    <StackLayout Spacing="8">
                        <Label Text="Stock *"
                               FontSize="14"
                               FontAttributes="Bold"
                               TextColor="#2D3436" />
                        <Entry Text="{Binding StockText}"
                               Keyboard="Numeric"
                               Placeholder="0"
                               FontSize="16"
                               TextColor="#2D3436"
                               FontAttributes="Bold" />
                    </StackLayout>
                </Border>
            </Grid>

            <!-- CategorÃ­a -->
            <Border BackgroundColor="White"
                    Padding="16"
                    StrokeThickness="0">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="12" />
                </Border.StrokeShape>
                <Border.Shadow>
                    <Shadow Brush="Black" Opacity="0.05" Radius="10" Offset="0,2" />
                </Border.Shadow>

                <StackLayout Spacing="8">
                    <Label Text="Category *"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="#2D3436" />
                    <Picker ItemsSource="{Binding Categories}"
                            SelectedItem="{Binding Category}"
                            Title="Selecciona una categorÃ­a"
                            FontSize="16"
                            TextColor="#2D3436"
                            FontAttributes="Bold" />
                </StackLayout>
            </Border>

            <!-- Botones -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="15" Margin="0,10,0,20">
                <Button Grid.Column="0"
                        Text="Cancelar"
                        FontSize="16"
                        BackgroundColor="Black"
                        TextColor="White"
                        BorderColor="#DFE6E9"
                        BorderWidth="2"
                        CornerRadius="12"
                        Padding="16"
                        Command="{Binding CancelCommand}" />

                <Button Grid.Column="1"
                        Text="ðŸ’¾ Guardar"
                        FontSize="16"
                        BackgroundColor="#27AE60"
                        TextColor="White"
                        CornerRadius="12"
                        Padding="16"
                        Command="{Binding SaveCommand}" />
            </Grid>
        </StackLayout>
    </ScrollView>
</ContentPage>